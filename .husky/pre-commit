#!/usr/bin/env sh
. "$(dirname -- "$0")/_/husky.sh"

echo "ğŸ” Formatting staged files..."
npx lint-staged || { echo "âŒ Formatting failed"; exit 1; }

echo "ğŸ” Type checking server..."
( cd server && npm run build ) || { echo "âŒ Server type check failed"; exit 1; }

echo "ğŸ” Type checking client..."
( cd client && npm run build ) || { echo "âŒ Client type check failed"; exit 1; }

echo "ğŸ” Linting server..."
( cd server && npm run lint ) || { echo "âŒ Server lint failed"; exit 1; }

echo "ğŸ” Linting client..."
( cd client && npm run lint ) || { echo "âŒ Client lint failed"; exit 1; }

# Optional: Run tests (uncomment if you want tests on every commit)
# echo "ğŸ§ª Running server tests..."
# ( cd server && npm test ) || { echo "âŒ Server tests failed"; exit 1; }

echo "âœ… Pre-commit checks passed!"